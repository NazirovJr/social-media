{"ast":null,"code":"import _regeneratorRuntime from\"G:/projects/React and JS/scocial media/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"G:/projects/React and JS/scocial media/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"G:/projects/React and JS/scocial media/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{authAPI}from\"../API/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='auth/SET-USER-DATA';var InitializeState={userId:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:InitializeState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);default:return state;}};export var setUser=function setUser(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var authUser=function authUser(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data,_data$data,id,email,login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.authUser();case 2:data=_context.sent;if(data.resultCode===0){_data$data=data.data,id=_data$data.id,email=_data$data.email,login=_data$data.login;dispatch(setUser(id,email,login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loginUser=function loginUser(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data,msgError;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.loginUser(email,password,rememberMe);case 2:data=_context2.sent;if(data.resultCode===0){dispatch(authUser());}else{msgError=data.messages.length>0?data.messages:\"Common Error\";dispatch(stopSubmit(\"login\",{_error:msgError}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logoutUser=function logoutUser(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logoutUser();case 2:data=_context3.sent;if(data.resultCode===0){dispatch(setUser(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["G:/projects/React and JS/scocial media/my-app/src/Redux/authReducer.js"],"names":["authAPI","stopSubmit","SET_USER_DATA","InitializeState","userId","email","login","isAuth","authReducer","state","action","type","payload","setUser","authUser","dispatch","data","resultCode","id","loginUser","password","rememberMe","msgError","messages","length","_error","logoutUser"],"mappings":"weAAA,OAAQA,OAAR,KAAsB,YAAtB,CACA,OAAQC,UAAR,KAAyB,YAAzB,CAEA,GAAMC,CAAAA,aAAa,CAAG,oBAAtB,CAEA,GAAMC,CAAAA,eAAe,CAAG,CACpBC,MAAM,CAAE,IADY,CAEpBC,KAAK,CAAE,IAFa,CAGpBC,KAAK,CAAE,IAHa,CAIpBC,MAAM,CAAE,KAJY,CAAxB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAqC,IAApCC,CAAAA,KAAoC,2DAA5BN,eAA4B,IAAXO,CAAAA,MAAW,2CACrD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKT,CAAAA,aAAL,CACI,sCACOO,KADP,EAEOC,MAAM,CAACE,OAFd,EAIJ,QACI,MAAOH,CAAAA,KAAP,CAPR,CASH,CAVD,CAYA,MAAO,IAAMI,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAAmC,CACtDI,IAAI,CAAET,aADgD,CAEtDU,OAAO,CAAE,CAACR,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAAuBC,MAAM,CAANA,MAAvB,CAF6C,CAAnC,EAAhB,CAKP,MAAO,IAAMO,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CAC1B,+FAAO,iBAAOC,QAAP,2KACgBf,CAAAA,OAAO,CAACc,QAAR,EADhB,QACGE,IADH,eAEH,GAAIA,IAAI,CAACC,UAAL,GAAoB,CAAxB,CAA2B,YACED,IAAI,CAACA,IADP,CAClBE,EADkB,YAClBA,EADkB,CACdb,KADc,YACdA,KADc,CACPC,KADO,YACPA,KADO,CAEvBS,QAAQ,CAACF,OAAO,CAACK,EAAD,CAAKb,KAAL,CAAYC,KAAZ,CAAmB,IAAnB,CAAR,CAAR,CACH,CALE,sDAAP,+DAOH,CARM,CASP,MAAO,IAAMa,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACd,KAAD,CAAQe,QAAR,CAAkBC,UAAlB,CAAiC,CACtD,gGAAO,kBAAON,QAAP,+JACgBf,CAAAA,OAAO,CAACmB,SAAR,CAAkBd,KAAlB,CAAyBe,QAAzB,CAAmCC,UAAnC,CADhB,QACGL,IADH,gBAEH,GAAIA,IAAI,CAACC,UAAL,GAAoB,CAAxB,CAA2B,CACvBF,QAAQ,CAACD,QAAQ,EAAT,CAAR,CACH,CAFD,IAEO,CACGQ,QADH,CACcN,IAAI,CAACO,QAAL,CAAcC,MAAd,CAAuB,CAAvB,CAA2BR,IAAI,CAACO,QAAhC,CAA2C,cADzD,CAEHR,QAAQ,CAACd,UAAU,CAAC,OAAD,CAAU,CAACwB,MAAM,CAAEH,QAAT,CAAV,CAAX,CAAR,CACH,CAPE,wDAAP,iEASH,CAVM,CAWP,MAAO,IAAMI,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CAC5B,gGAAO,kBAAOX,QAAP,sJACgBf,CAAAA,OAAO,CAAC0B,UAAR,EADhB,QACGV,IADH,gBAEC,GAAIA,IAAI,CAACC,UAAL,GAAoB,CAAxB,CAA2B,CACvBF,QAAQ,CAACF,OAAO,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAR,CAAR,CACH,CAJF,wDAAP,iEAMH,CAPM,CAQP,cAAeL,CAAAA,WAAf","sourcesContent":["import {authAPI} from \"../API/api\";\r\nimport {stopSubmit} from \"redux-form\";\r\n\r\nconst SET_USER_DATA = 'auth/SET-USER-DATA'\r\n\r\nconst InitializeState = {\r\n    userId: null,\r\n    email: null,\r\n    login: null,\r\n    isAuth: false\r\n}\r\n\r\nconst authReducer = (state = InitializeState, action) => {\r\n    switch (action.type) {\r\n        case SET_USER_DATA:\r\n            return {\r\n                ...state,\r\n                ...action.payload,\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setUser = (userId, email, login, isAuth) => ({\r\n    type: SET_USER_DATA,\r\n    payload: {userId, email, login, isAuth}\r\n})\r\n\r\nexport const authUser = () => {\r\n    return async (dispatch) => {\r\n        const data = await authAPI.authUser()\r\n        if (data.resultCode === 0) {\r\n            let {id, email, login} = data.data\r\n            dispatch(setUser(id, email, login, true))\r\n        }\r\n    }\r\n}\r\nexport const loginUser = (email, password, rememberMe) => {\r\n    return async (dispatch) => {\r\n        const data = await authAPI.loginUser(email, password, rememberMe)\r\n        if (data.resultCode === 0) {\r\n            dispatch(authUser())\r\n        } else {\r\n            const msgError = data.messages.length > 0 ? data.messages : \"Common Error\"\r\n            dispatch(stopSubmit(\"login\", {_error: msgError}))\r\n        }\r\n    }\r\n}\r\nexport const logoutUser = () => {\r\n    return async (dispatch) => {\r\n        const data = await authAPI.logoutUser()\r\n            if (data.resultCode === 0) {\r\n                dispatch(setUser(null, null, null, false))\r\n            }\r\n    }\r\n}\r\nexport default authReducer"]},"metadata":{},"sourceType":"module"}